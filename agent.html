<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Art World RPG</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <!-- Game Header -->
  <div class="game-header">
    <h1>🎨 Art World RPG</h1>
  </div>

  <!-- Main Game Layout -->
  <div class="game-main">
    <!-- Game Canvas Container -->
    <div class="game-canvas-container">
      <div class="loading-screen hidden" id="loadingScreen">
        <div class="loader"></div>
      </div>

      <!-- Game Canvas -->
      <canvas id="gameCanvas" width="800" height="600"></canvas>

      <!-- Money Display Overlay -->
      <div class="money-overlay" id="moneyOverlay">
        $<span id="moneyText">50</span>
      </div>

      <!-- Dialogue Overlay (positioned over canvas) -->
      <div class="dialogue-overlay hidden" id="dialogueBox">
        <div class="dialogue-text" id="dialogueText"></div>
        <div id="dialogueOptions"></div>
        <button class="close-button hidden" id="closeDialogue">Close</button>
      </div>
    </div>

    <!-- Right Sidebar with UI Panels -->
    <div class="game-sidebar">
      <!-- Well-being Panel -->
      <div class="sidebar-panel hp-panel">
        <div class="panel-header">
          💚 Well-being
        </div>
        <div class="hp-bar">
          <div class="hp-fill" id="hpFill" style="width: 100%;"></div>
          <div class="hp-text" id="hpText">100/100</div>
        </div>
      </div>

      <!-- Energy Panel -->
      <div class="sidebar-panel hp-panel">
        <div class="panel-header">
          ⚡ Energy
        </div>
        <div class="hp-bar">
          <div class="hp-fill" id="energyFill" style="width: 100%; background: linear-gradient(90deg, #4299e1, #3182ce);"></div>
          <div class="hp-text" id="energyText">100/100</div>
        </div>
      </div>

      <!-- Art Supplies Panel -->
      <div class="sidebar-panel backpack-panel">
        <div class="panel-header">
          🎒 Art Supplies
        </div>
        <div id="backpackList">
          <!-- Backpack items will be dynamically generated here -->
        </div>
      </div>

      <!-- Skills Panel -->
      <div class="sidebar-panel stats-panel" id="statsPanel">
        <div class="panel-header">
          📊 Artistic Skills
        </div>
        <button class="stats-toggle" id="toggleStatsPanel">Toggle Details</button>
        <div class="collapsible-content" id="statsContent">
          <div id="skillList">
            <!-- Skill rows will be dynamically generated here -->
          </div>
        </div>
      </div>

      <!-- Crafting Panel -->
      <div class="sidebar-panel stats-panel">
        <div class="panel-header">
          🎨 Create Art
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 4px; margin-bottom: 8px;">
          <button id="craft_pencil_sketch" class="stats-toggle" onclick="startCrafting('pencil_sketch')" 
                  style="padding: 6px 4px; font-size: 10px;">
            ✏️ Sketch
          </button>
          <button id="craft_watercolor_painting" class="stats-toggle" onclick="startCrafting('watercolor_painting')" 
                  style="padding: 6px 4px; font-size: 10px;">
            🎨 Watercolor
          </button>
          <button id="craft_oil_painting" class="stats-toggle" onclick="startCrafting('oil_painting')" 
                  style="padding: 6px 4px; font-size: 10px;">
            🖼️ Oil Paint
          </button>
          <button id="craft_clay_sculpture" class="stats-toggle" onclick="startCrafting('clay_sculpture')" 
                  style="padding: 6px 4px; font-size: 10px;">
            🗿 Sculpture
          </button>
        </div>
        <div id="craftingStatus" style="font-size: 10px; color: #a0aec0; min-height: 20px;"></div>
        <button id="cancelCrafting" onclick="cancelCrafting()" 
                style="display: none; padding: 4px 8px; font-size: 10px; background: #f56565; margin-top: 4px;">
          Cancel
        </button>
      </div>
    </div>
  </div>
  <!-- AI Visualization Panel -->
  <div class="ai-visualization" id="aiVisualization" style="display: none;">
    <h3 style="margin: 0 0 10px 0; font-size: 14px; color: #90cdf4;">🤖 AI Agent Mind</h3>
    
    <div class="emotion-section">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <span>Boredom</span>
        <span id="boredomValue">0</span>
      </div>
      <div class="emotion-bar">
        <div class="emotion-fill" id="boredomBar" style="background: #fbbf24; width: 0%;"></div>
      </div>
      
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <span>Frustration</span>
        <span id="frustrationValue">0</span>
      </div>
      <div class="emotion-bar">
        <div class="emotion-fill" id="frustrationBar" style="background: #f87171; width: 0%;"></div>
      </div>
      
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <span>Curiosity</span>
        <span id="curiosityValue">100</span>
      </div>
      <div class="emotion-bar">
        <div class="emotion-fill" id="curiosityBar" style="background: #a78bfa; width: 100%;"></div>
      </div>
    </div>
    
    <div class="ai-thought" id="aiThought">
      Initializing...
    </div>
    
    <div style="margin-top: 10px; font-size: 10px; opacity: 0.7;">
      <div>Locations visited: <span id="locationsVisited">0</span></div>
      <div>NPCs met: <span id="npcsKnown">0</span></div>
      <div>Last action: <span id="lastAction">None</span></div>
    </div>
  </div>
  <!-- Game Scripts -->
  <script src="js/entities.js"></script>
  <script src="js/state.js"></script>
  <script src="js/maps.js"></script>
  <script src="js/pathfinding.js"></script>
  <script src="js/drawing.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/crafting.js"></script>
  <script src="js/main.js"></script>
  <!-- Load AI Agent -->
     
  <!-- Include the full AI Agent code -->
  <script src="ai-agent.js"></script>

  <script>
    // Insert the AI Agent code here or load from external file
    // Copy the entire AI Agent code from the first artifact
    
    // Enhanced visualization updates
    let aiVisualizationInterval;
    
    function updateAIVisualization() {
      if (typeof aiAgent !== 'undefined' && aiAgent.isRunning) {
        document.getElementById('aiVisualization').style.display = 'block';
        
        // Update emotion bars
        document.getElementById('boredomValue').textContent = Math.round(aiAgent.emotionalState.boredom);
        document.getElementById('boredomBar').style.width = aiAgent.emotionalState.boredom + '%';
        
        document.getElementById('frustrationValue').textContent = Math.round(aiAgent.emotionalState.frustration);
        document.getElementById('frustrationBar').style.width = aiAgent.emotionalState.frustration + '%';
        
        document.getElementById('curiosityValue').textContent = Math.round(aiAgent.emotionalState.curiosity);
        document.getElementById('curiosityBar').style.width = aiAgent.emotionalState.curiosity + '%';
        
        // Update stats
        document.getElementById('locationsVisited').textContent = aiAgent.memory.visitedLocations.size;
        document.getElementById('npcsKnown').textContent = aiAgent.memory.knownNPCs.size;
        
        // Update last action
        if (aiAgent.memory.lastActions.length > 0) {
          const lastAction = aiAgent.memory.lastActions[aiAgent.memory.lastActions.length - 1];
          document.getElementById('lastAction').textContent = lastAction.description || lastAction.type;
        }
        
        // Update thought bubble
        const thoughts = [
          aiAgent.emotionalState.boredom > 60 ? "I'm getting bored..." : null,
          aiAgent.emotionalState.frustration > 60 ? "This is frustrating!" : null,
          aiAgent.emotionalState.curiosity > 80 ? "I wonder what's over there?" : null,
          aiAgent.memory.stuckCounter > 5 ? "I seem to be stuck..." : null,
          Object.values(gameState.quests).some(q => q === 'accepted') ? "I should complete my quests." : null,
          gameState.player.energy < 30 ? "I'm getting tired..." : null,
          gameState.player.money > 200 ? "I'm doing well financially!" : null
        ].filter(t => t !== null);
        
        if (thoughts.length > 0) {
          document.getElementById('aiThought').textContent = thoughts[Math.floor(Math.random() * thoughts.length)];
        }
      } else {
        document.getElementById('aiVisualization').style.display = 'none';
      }
    }
    
    // Start visualization updates
    aiVisualizationInterval = setInterval(updateAIVisualization, 500);
  </script>

</body>

</html>